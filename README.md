Implementation of the Marrakech game.